(function(){var i=0,n=1,o=3;function s(){this.a=[];for(var a=0;a<12;++a){this.a.push(a);this.a.push(a)}this.b=[]}function t(a,c){var d=a.c;if(!a.b[c]&&d!=c)if(d!=null){a.c=null;if(a.a[c]==a.a[d]){a.b[d]=true;a.b[c]=true;return i}else return n}else{a.c=c;return o}else return 2}function x(a){for(var c=0,d=0;d<24;++d)a.b[d]&&++c;return c/2}s.prototype.reset=function(){for(var a=this.a,c=a.length;c>1;--c){var d=Math.floor(Math.random()*c),h=a[d];a[d]=a[c-1];a[c-1]=h}for(a=0;a<24;++a)this.b[a]=false};var y=true;try{document.createEvent("TouchEvent")}catch(z){y=false}var A=null,B=0;
function C(a){a.preventDefault();var c="";switch(a.type){case "mousedown":c="touchstart";A=a.target;break;case "mousemove":if(!A)return;c="touchmove";break;case "mouseup":c="touchend";B++}a={clientX:a.clientX,clientY:a.clientY,identifier:B,pageX:a.pageX,pageY:a.pageY,screenX:a.screenX,screenY:a.screenY,target:A};var d=document.createEvent("UIEvent");d.initEvent(c,true,false);d.type=c;d.touches=c=="touchend"?[]:[a];d.targetTouches=c=="touchend"?[]:[a];d.changedTouches=[a];A.dispatchEvent(d);if(c==
"touchend")A=null};var D=0;function G(){return Math.max(0,1E3-Math.floor((Date.now()-D)/1E3))}var H,I;window.vipgames.api.register({game_id:"bruno.memory3d",load:function(a){function c(){var h=a.getScene();I=document.createElement("div");h.appendChild(I);J()}function d(){I.parentNode.removeChild(I)}H=a;a.game_load({getScores:G,stop:function(){d();c()},unload:d},c)}});
function J(){function a(b){b.style.webkitTransform=j?"translateZ(50px)":"scale(1.2,1.2)";b.style.opacity="0"}function c(b){b.style.webkitTransform=j?"translateZ(0)":"scale(1,1)";b.style.opacity="1"}function d(){D=Date.now();H.game_start(function(){k.reset();for(var b=0;b<l.length;++b){var g=k.a[b],e=l[b];e.className="card front";e.style.backgroundPosition=(j?100:60)*(g+1)+"px";c(m[b])}document.getElementById("score").innerText="0 / 12"})}function h(b){b=b.changedTouches[0];var g=u-b.screenY;E+=v-
b.screenX;F+=g;if(w){var e=b.target.d;if(e!=null){var f=k.c;switch(t(k,e)){case n:a(m[e]);setTimeout(function(){c(m[f]);c(m[e])},500);break;case i:a(m[e]);l[f].className+=" found";l[e].className+=" found";document.getElementById("score").innerText=x(k)+" / 12";if(k.b.indexOf(false)==-1){H.game_end();alert("Nice! Your time score "+G()+".");d()}break;case o:a(m[e])}}}}if(!y){document.addEventListener("mousemove",C,true);document.addEventListener("mouseup",C,true);document.addEventListener("mousedown",
C,true)}var j=navigator.userAgent.indexOf("iPhone")>=0||navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("iPod")>=0;if(j)I.className+=" has3D";I.innerHTML='<div id="stage"><div id="cube"></div></div><div id="memoryActions" class="hud"><a id="newGame" href="#">New Game</a> - <a id="quit" href="#">Quit</a></div><span id="score" class="hud"></span>';var p=document.getElementById("stage"),q=document.getElementById("cube"),v,u,E=0,F=0,w,k=new s;q.innerHTML=function(){var b="";if(j)for(var g=
["Y(0","Y(90","Y(180","Y(270","X(90","X(-90"],e=0;e<6;++e){b+="<div class='side' style='-webkit-transform: rotate"+g[e]+"deg) translateZ(100px)'>";b+="<div style='position:absolute'>";for(var f=0;f<4;++f)b+="<div class='card front'></div>";b+="</div>";b+="<div style='pointer-events:none; position:absolute'>";for(f=0;f<4;++f)b+="<div class='card back'></div>";b+="</div>";b+="</div>"}else for(e=0;e<6;++e){b+="<div class='side'>";b+="<div style='position:absolute'>";for(f=0;f<4;++f)b+="<div class='card front'></div>";
b+="</div>";b+="<div style='pointer-events:none; position:absolute'>";for(f=0;f<4;++f)b+="<div class='card back'></div>";b+="</div>";b+="</div>"}return b}();for(var l=q.querySelectorAll(".front"),m=q.querySelectorAll(".back"),r=0;r<l.length;++r)l[r].d=r;p.addEventListener("touchstart",function(b){b=b.touches[0];v=b.screenX;u=b.screenY;w=true},false);j&&p.addEventListener("touchmove",function(b){var g=b.touches[0];b=v-g.screenX;g=u-g.screenY;q.style.webkitTransform="rotateY("+-(b+E)+"deg) rotateX("+
(g+F)+"deg)";if(Math.abs(b)>10||Math.abs(g)>10)w=false},false);p.addEventListener("touchend",h,false);p.addEventListener("touchcancel",h,false);window.addEventListener("load",function(){setTimeout(function(){window.scrollTo(0,1)},100)},false);document.getElementById("newGame").addEventListener("click",function(){H.game_end();d()},false);document.getElementById("quit").addEventListener("click",function(){D=0;H.game_quit()},false);document.addEventListener("touchstart",function(b){b.preventDefault();
window.scrollTo(0,1)},false);d()};})()
